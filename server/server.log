
> server@1.0.0 start
> node server.js

Initializing Market Data Service...
MarketData model created
Market data polling started (interval: 5000ms)
Market Data Service initialized
Server running on port 3008
Initializing Prop Firm Service...
PropFirmRules model created
Updating prop firm rules (using mock data)...
MongoDB connected: localhost
Rules saved for ApexTraderFunding
Rules saved for TakeProfitTrader
Prop firm rules updated successfully
Prop Firm Service initialized
Backtest Service initialized
Risk Management Service initialized
Journal Service initialized
Analytics Service initialized
Alert Service initialized
Initializing trading session service...
Starting periodic health check every 5 minutes
Performing initial session analysis...
Initial health check: System is operational
Initial analysis for preMarket session completed
Initial analysis for regularHours session completed
Initial analysis for postMarket session completed
Initial analysis for overnight session completed
All services initialized successfully
Market data saved to database
Market data updated: NQ - Volatility: LOW
Market data update emitted to clients
[2025-03-22T13:07:21.264Z] GET /api/template-recommendations/recommend?type=ATM&dayOfWeek=Saturday&session=Early%20Morning&volatility=Medium
Received request to /recommend
Getting recommended template...
Selecting ATM template for: Day=Any, Session=Closed, Volatility=None
Found fallback template: ATM_EA_HIGH
Template found: {
  session: 'Unknown_Session',
  volatility: 'Normal_Volatility',
  dayOfWeek: null,
  _id: new ObjectId('67db9e940bc2206f55456a22'),
  templateName: 'ATM_EA_HIGH',
  fileName: 'ATM_EA_HIGH.xml',
  filePath: 'C:\\Users\\bridg\\Documents\\NinjaTrader 8\\templates\\ATM\\ATM_EA_HIGH.xml',
  calculationMode: 'Ticks',
  defaultQuantity: 1,
  timeInForce: 'Gtc',
  brackets: [
    {
      stopStrategy: [Object],
      quantity: 1,
      stopLoss: 58,
      target: 116,
      _id: new ObjectId('67db9e940bc2206f55456a23')
    }
  ],
  isChase: false,
  chaseLimit: 0,
  isTargetChase: false,
  reverseAtStop: false,
  reverseAtTarget: false,
  marketCondition: 'Early_Afternoon',
  description: 'ATM_EA_HIGH ATM Strategy Template',
  xmlContent: '﻿<?xml version="1.0" encoding="utf-8"?>\r\n' +
    '<NinjaTrader>\r\n' +
    '  <AtmStrategy xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\r\n' +
    '    <IsVisible>true</IsVisible>\r\n' +
    '    <AreLinesConfigurable>true</AreLinesConfigurable>\r\n' +
    '    <ArePlotsConfigurable>true</ArePlotsConfigurable>\r\n' +
    '    <BarsToLoad>0</BarsToLoad>\r\n' +
    '    <DisplayInDataBox>true</DisplayInDataBox>\r\n' +
    '    <From>2099-12-01T00:00:00</From>\r\n' +
    '    <Panel>0</Panel>\r\n' +
    '    <ScaleJustification>Right</ScaleJustification>\r\n' +
    '    <ShowTransparentPlotsInDataBox>false</ShowTransparentPlotsInDataBox>\r\n' +
    '    <To>1800-01-01T00:00:00</To>\r\n' +
    '    <Calculate>OnBarClose</Calculate>\r\n' +
    '    <Displacement>0</Displacement>\r\n' +
    '    <IsAutoScale>true</IsAutoScale>\r\n' +
    '    <IsDataSeriesRequired>false</IsDataSeriesRequired>\r\n' +
    '    <IsOverlay>false</IsOverlay>\r\n' +
    '    <Lines />\r\n' +
    '    <MaximumBarsLookBack>TwoHundredFiftySix</MaximumBarsLookBack>\r\n' +
    '    <n>AtmStrategy</n>\r\n' +
    '    <Plots />\r\n' +
    '    <SelectedValueSeries>0</SelectedValueSeries>\r\n' +
    '    <BarsRequiredToTrade>0</BarsRequiredToTrade>\r\n' +
    '    <Category>Atm</Category>\r\n' +
    '    <ConnectionLossHandling>KeepRunning</ConnectionLossHandling>\r\n' +
    '    <DaysToLoad>1</DaysToLoad>\r\n' +
    '    <DefaultQuantity>1</DefaultQuantity>\r\n' +
    '    <DisconnectDelaySeconds>0</DisconnectDelaySeconds>\r\n' +
    '    <EntriesPerDirection>1</EntriesPerDirection>\r\n' +
    '    <EntryHandling>AllEntries</EntryHandling>\r\n' +
    '    <ExitOnSessionCloseSeconds>0</ExitOnSessionCloseSeconds>\r\n' +
    '    <IncludeCommission>false</IncludeCommission>\r\n' +
    '    <IsAggregated>false</IsAggregated>\r\n' +
    '    <IsExitOnSessionCloseStrategy>false</IsExitOnSessionCloseStrategy>\r\n' +
    '    <IsFillLimitOnTouch>false</IsFillLimitOnTouch>\r\n' +
    '    <IsOptimizeDataSeries>false</IsOptimizeDataSeries>\r\n' +
    '    <IsStableSession>false</IsStableSession>\r\n' +
    '    <IsTickReplay>false</IsTickReplay>\r\n' +
    '    <IsTradingHoursBreakLineVisible>false</IsTradingHoursBreakLineVisible>\r\n' +
    '    <IsWaitUntilFlat>false</IsWaitUntilFlat>\r\n' +
    '    <NumberRestartAttempts>0</NumberRestartAttempts>\r\n' +
    '    <OptimizationPeriod>10</OptimizationPeriod>\r\n' +
    '    <OrderFillResolution>High</OrderFillResolution>\r\n' +
    '    <OrderFillResolutionType>Tick</OrderFillResolutionType>\r\n' +
    '    <OrderFillResolutionValue>1</OrderFillResolutionValue>\r\n' +
    '    <RestartsWithinMinutes>0</RestartsWithinMinutes>\r\n' +
    '    <SetOrderQuantity>Strategy</SetOrderQuantity>\r\n' +
    '    <Slippage>0</Slippage>\r\n' +
    '    <StartBehavior>AdoptAccountPosition</StartBehavior>\r\n' +
    '    <StopTargetHandling>ByStrategyPosition</StopTargetHandling>\r\n' +
    '    <SupportsOptimizationGraph>false</SupportsOptimizationGraph>\r\n' +
    '    <TestPeriod>28</TestPeriod>\r\n' +
    '    <TradingHoursSerializable />\r\n' +
    '    <Gtd>1800-01-01T00:00:00</Gtd>\r\n' +
    '    <Template>ATM_EA_HIGH</Template>\r\n' +
    '    <TimeInForce>Gtc</TimeInForce>\r\n' +
    '    <AtmSelector>e017660a189640f698c5fa810e4fe499</AtmSelector>\r\n' +
    '    <OnBehalfOf />\r\n' +
    '    <ReverseAtStopStrategyId>-1</ReverseAtStopStrategyId>\r\n' +
    '    <ReverseAtTargetStrategyId>-1</ReverseAtTargetStrategyId>\r\n' +
    '    <ShadowStrategyStrategyId>-1</ShadowStrategyStrategyId>\r\n' +
    '    <ShadowTemplate />\r\n' +
    '    <Brackets>\r\n' +
    '      <Bracket>\r\n' +
    '        <Quantity>1</Quantity>\r\n' +
    '        <StopLoss>58</StopLoss>\r\n' +
    '        <StopStrategy>\r\n' +
    '          <AutoBreakEvenPlus>29</AutoBreakEvenPlus>\r\n' +
    '          <AutoBreakEvenProfitTrigger>58</AutoBreakEvenProfitTrigger>\r\n' +
    '          <AutoTrailSteps />\r\n' +
    '          <IsSimStopEnabled>false</IsSimStopEnabled>\r\n' +
    '          <VolumeTrigger>0</VolumeTrigger>\r\n' +
    '          <Template />\r\n' +
    '        </StopStrategy>\r\n' +
    '        <Target>116</Target>\r\n' +
    '      </Bracket>\r\n' +
    '    </Brackets>\r\n' +
    '    <CalculationMode>Ticks</CalculationMode>\r\n' +
    '    <ChaseLimit>0</ChaseLimit>\r\n' +
    '    <EntryQuantity>1</EntryQuantity>\r\n' +
    '    <InitialTickSize>0</InitialTickSize>\r\n' +
    '    <IsChase>false</IsChase>\r\n' +
    '    <IsChaseIfTouched>false</IsChaseIfTouched>\r\n' +
    '    <IsTargetChase>false</IsTargetChase>\r\n' +
    '    <ReverseAtStop>false</ReverseAtStop>\r\n' +
    '    <ReverseAtTarget>false</ReverseAtTarget>\r\n' +
    '    <UseMitForProfit>false</UseMitForProfit>\r\n' +
    '    <UseStopLimitForStopLossOrders>false</UseStopLimitForStopLossOrders>\r\n' +
    '  </AtmStrategy>\r\n' +
    '</NinjaTrader>',
  lastModified: 2025-03-20T04:50:28.783Z,
  __v: 0,
  createdAt: 2025-03-22T13:07:21.282Z
}
[2025-03-22T13:07:21.289Z] GET /api/template-recommendations/recommend?type=ATM&dayOfWeek=Saturday&session=Early%20Morning&volatility=Medium
Received request to /recommend
Getting recommended template...
Selecting ATM template for: Day=Any, Session=Closed, Volatility=None
Found fallback template: ATM_EA_HIGH
Template found: {
  session: 'Unknown_Session',
  volatility: 'Normal_Volatility',
  dayOfWeek: null,
  _id: new ObjectId('67db9e940bc2206f55456a22'),
  templateName: 'ATM_EA_HIGH',
  fileName: 'ATM_EA_HIGH.xml',
  filePath: 'C:\\Users\\bridg\\Documents\\NinjaTrader 8\\templates\\ATM\\ATM_EA_HIGH.xml',
  calculationMode: 'Ticks',
  defaultQuantity: 1,
  timeInForce: 'Gtc',
  brackets: [
    {
      stopStrategy: [Object],
      quantity: 1,
      stopLoss: 58,
      target: 116,
      _id: new ObjectId('67db9e940bc2206f55456a23')
    }
  ],
  isChase: false,
  chaseLimit: 0,
  isTargetChase: false,
  reverseAtStop: false,
  reverseAtTarget: false,
  marketCondition: 'Early_Afternoon',
  description: 'ATM_EA_HIGH ATM Strategy Template',
  xmlContent: '﻿<?xml version="1.0" encoding="utf-8"?>\r\n' +
    '<NinjaTrader>\r\n' +
    '  <AtmStrategy xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\r\n' +
    '    <IsVisible>true</IsVisible>\r\n' +
    '    <AreLinesConfigurable>true</AreLinesConfigurable>\r\n' +
    '    <ArePlotsConfigurable>true</ArePlotsConfigurable>\r\n' +
    '    <BarsToLoad>0</BarsToLoad>\r\n' +
    '    <DisplayInDataBox>true</DisplayInDataBox>\r\n' +
    '    <From>2099-12-01T00:00:00</From>\r\n' +
    '    <Panel>0</Panel>\r\n' +
    '    <ScaleJustification>Right</ScaleJustification>\r\n' +
    '    <ShowTransparentPlotsInDataBox>false</ShowTransparentPlotsInDataBox>\r\n' +
    '    <To>1800-01-01T00:00:00</To>\r\n' +
    '    <Calculate>OnBarClose</Calculate>\r\n' +
    '    <Displacement>0</Displacement>\r\n' +
    '    <IsAutoScale>true</IsAutoScale>\r\n' +
    '    <IsDataSeriesRequired>false</IsDataSeriesRequired>\r\n' +
    '    <IsOverlay>false</IsOverlay>\r\n' +
    '    <Lines />\r\n' +
    '    <MaximumBarsLookBack>TwoHundredFiftySix</MaximumBarsLookBack>\r\n' +
    '    <n>AtmStrategy</n>\r\n' +
    '    <Plots />\r\n' +
    '    <SelectedValueSeries>0</SelectedValueSeries>\r\n' +
    '    <BarsRequiredToTrade>0</BarsRequiredToTrade>\r\n' +
    '    <Category>Atm</Category>\r\n' +
    '    <ConnectionLossHandling>KeepRunning</ConnectionLossHandling>\r\n' +
    '    <DaysToLoad>1</DaysToLoad>\r\n' +
    '    <DefaultQuantity>1</DefaultQuantity>\r\n' +
    '    <DisconnectDelaySeconds>0</DisconnectDelaySeconds>\r\n' +
    '    <EntriesPerDirection>1</EntriesPerDirection>\r\n' +
    '    <EntryHandling>AllEntries</EntryHandling>\r\n' +
    '    <ExitOnSessionCloseSeconds>0</ExitOnSessionCloseSeconds>\r\n' +
    '    <IncludeCommission>false</IncludeCommission>\r\n' +
    '    <IsAggregated>false</IsAggregated>\r\n' +
    '    <IsExitOnSessionCloseStrategy>false</IsExitOnSessionCloseStrategy>\r\n' +
    '    <IsFillLimitOnTouch>false</IsFillLimitOnTouch>\r\n' +
    '    <IsOptimizeDataSeries>false</IsOptimizeDataSeries>\r\n' +
    '    <IsStableSession>false</IsStableSession>\r\n' +
    '    <IsTickReplay>false</IsTickReplay>\r\n' +
    '    <IsTradingHoursBreakLineVisible>false</IsTradingHoursBreakLineVisible>\r\n' +
    '    <IsWaitUntilFlat>false</IsWaitUntilFlat>\r\n' +
    '    <NumberRestartAttempts>0</NumberRestartAttempts>\r\n' +
    '    <OptimizationPeriod>10</OptimizationPeriod>\r\n' +
    '    <OrderFillResolution>High</OrderFillResolution>\r\n' +
    '    <OrderFillResolutionType>Tick</OrderFillResolutionType>\r\n' +
    '    <OrderFillResolutionValue>1</OrderFillResolutionValue>\r\n' +
    '    <RestartsWithinMinutes>0</RestartsWithinMinutes>\r\n' +
    '    <SetOrderQuantity>Strategy</SetOrderQuantity>\r\n' +
    '    <Slippage>0</Slippage>\r\n' +
    '    <StartBehavior>AdoptAccountPosition</StartBehavior>\r\n' +
    '    <StopTargetHandling>ByStrategyPosition</StopTargetHandling>\r\n' +
    '    <SupportsOptimizationGraph>false</SupportsOptimizationGraph>\r\n' +
    '    <TestPeriod>28</TestPeriod>\r\n' +
    '    <TradingHoursSerializable />\r\n' +
    '    <Gtd>1800-01-01T00:00:00</Gtd>\r\n' +
    '    <Template>ATM_EA_HIGH</Template>\r\n' +
    '    <TimeInForce>Gtc</TimeInForce>\r\n' +
    '    <AtmSelector>e017660a189640f698c5fa810e4fe499</AtmSelector>\r\n' +
    '    <OnBehalfOf />\r\n' +
    '    <ReverseAtStopStrategyId>-1</ReverseAtStopStrategyId>\r\n' +
    '    <ReverseAtTargetStrategyId>-1</ReverseAtTargetStrategyId>\r\n' +
    '    <ShadowStrategyStrategyId>-1</ShadowStrategyStrategyId>\r\n' +
    '    <ShadowTemplate />\r\n' +
    '    <Brackets>\r\n' +
    '      <Bracket>\r\n' +
    '        <Quantity>1</Quantity>\r\n' +
    '        <StopLoss>58</StopLoss>\r\n' +
    '        <StopStrategy>\r\n' +
    '          <AutoBreakEvenPlus>29</AutoBreakEvenPlus>\r\n' +
    '          <AutoBreakEvenProfitTrigger>58</AutoBreakEvenProfitTrigger>\r\n' +
    '          <AutoTrailSteps />\r\n' +
    '          <IsSimStopEnabled>false</IsSimStopEnabled>\r\n' +
    '          <VolumeTrigger>0</VolumeTrigger>\r\n' +
    '          <Template />\r\n' +
    '        </StopStrategy>\r\n' +
    '        <Target>116</Target>\r\n' +
    '      </Bracket>\r\n' +
    '    </Brackets>\r\n' +
    '    <CalculationMode>Ticks</CalculationMode>\r\n' +
    '    <ChaseLimit>0</ChaseLimit>\r\n' +
    '    <EntryQuantity>1</EntryQuantity>\r\n' +
    '    <InitialTickSize>0</InitialTickSize>\r\n' +
    '    <IsChase>false</IsChase>\r\n' +
    '    <IsChaseIfTouched>false</IsChaseIfTouched>\r\n' +
    '    <IsTargetChase>false</IsTargetChase>\r\n' +
    '    <ReverseAtStop>false</ReverseAtStop>\r\n' +
    '    <ReverseAtTarget>false</ReverseAtTarget>\r\n' +
    '    <UseMitForProfit>false</UseMitForProfit>\r\n' +
    '    <UseStopLimitForStopLossOrders>false</UseStopLimitForStopLossOrders>\r\n' +
    '  </AtmStrategy>\r\n' +
    '</NinjaTrader>',
  lastModified: 2025-03-20T04:50:28.783Z,
  __v: 0,
  createdAt: 2025-03-22T13:07:21.298Z
}
Health check warning: System is degraded
Health check warning: System is degraded
