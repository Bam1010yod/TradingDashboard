
> server@1.0.0 start
> node server.js

Attempting to connect to MongoDB at: mongodb://localhost:27017/trading-dashboard
Initializing Market Data Service...
MarketData model created
Market data polling started (interval: 5000ms)
Market Data Service initialized
Server running on port 3008
Initializing Prop Firm Service...
PropFirmRules model created
Updating prop firm rules (using mock data)...
MongoDB connected: localhost
Available collections: flazhinfinities, atmstrategies, marketdatas, performancerecords, marketnews, alerts, propfirmrules, sessionanalyses, riskprofiles, flazhtemplates, tradejournals, atmtemplates, templates, backtests
Rules saved for ApexTraderFunding
Rules saved for TakeProfitTrader
Prop firm rules updated successfully
Prop Firm Service initialized
Backtest Service initialized
Risk Management Service initialized
Journal Service initialized
Analytics Service initialized
Alert Service initialized
Initializing trading session service...
Starting periodic health check every 5 minutes
Performing initial session analysis...
Initial health check: System is operational
Initial analysis for preMarket session completed
Initial analysis for regularHours session completed
Initial analysis for postMarket session completed
Initial analysis for overnight session completed
All services initialized successfully
[2025-03-25T10:03:05.169Z] GET /api/health
[2025-03-25T10:03:05.202Z] GET /api/health
[2025-03-25T10:03:05.234Z] GET /api/health
Market data saved to database
Market data updated: NQ - Volatility: LOW
Market data update emitted to clients
[2025-03-25T10:03:41.268Z] GET /recommendations.html
[2025-03-25T10:03:41.498Z] GET /api/enhancedTemplateRecommendations
Selecting Flazh template for: Day=Tuesday, Session=Pre_Market, Volatility=Medium_Volatility
Found fallback template: EA_HIGH
Getting performance metrics for Morning, Regular, volatility: 2.6227087201148707
Selecting ATM template for: Day=Tuesday, Session=Pre_Market, Volatility=Medium_Volatility
Found fallback template: ATM_EA_HIGH
Getting performance metrics for Morning, Regular, volatility: 2.910115766818449
[2025-03-25T10:03:50.198Z] POST /api/enhancedTemplateRecommendations/custom
Error in getCustomEnhancedTemplate: TypeError: basicSelector.getTemplateForConditions is not a function
    at Object.getCustomEnhancedTemplate (C:\TradingDashboard\server\services\enhancedTemplateSelector.js:193:54)
    at C:\TradingDashboard\server\routes\enhancedTemplateRecommendations.js:207:76
    at Layer.handle [as handle_request] (C:\TradingDashboard\server\node_modules\express\lib\router\layer.js:95:5)
    at next (C:\TradingDashboard\server\node_modules\express\lib\router\route.js:149:13)
    at Route.dispatch (C:\TradingDashboard\server\node_modules\express\lib\router\route.js:119:3)
    at Layer.handle [as handle_request] (C:\TradingDashboard\server\node_modules\express\lib\router\layer.js:95:5)
    at C:\TradingDashboard\server\node_modules\express\lib\router\index.js:284:15
    at Function.process_params (C:\TradingDashboard\server\node_modules\express\lib\router\index.js:346:12)
    at next (C:\TradingDashboard\server\node_modules\express\lib\router\index.js:280:10)
    at Function.handle (C:\TradingDashboard\server\node_modules\express\lib\router\index.js:175:3)
Error in getCustomEnhancedTemplate: TypeError: basicSelector.getTemplateForConditions is not a function
    at Object.getCustomEnhancedTemplate (C:\TradingDashboard\server\services\enhancedTemplateSelector.js:193:54)
    at C:\TradingDashboard\server\routes\enhancedTemplateRecommendations.js:218:74
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
[2025-03-25T10:03:56.053Z] GET /market-conditions.html
[2025-03-25T10:03:56.068Z] GET /api/market-conditions?timezone=US_CENTRAL
[2025-03-25T10:03:56.069Z] [INFO] Getting market conditions for timezone: US_CENTRAL
[2025-03-25T10:03:57.987Z] GET /recommendations.html
[2025-03-25T10:03:58.006Z] GET /api/enhancedTemplateRecommendations
Selecting Flazh template for: Day=Tuesday, Session=Pre_Market, Volatility=Medium_Volatility
Found fallback template: EA_HIGH
Getting performance metrics for Morning, Regular, volatility: 1.554867159394272
Selecting ATM template for: Day=Tuesday, Session=Pre_Market, Volatility=Medium_Volatility
Found fallback template: ATM_EA_HIGH
Getting performance metrics for Morning, Regular, volatility: 2.423036321230028
[2025-03-25T10:04:00.847Z] GET /market-conditions.html
[2025-03-25T10:04:00.862Z] GET /api/market-conditions?timezone=US_CENTRAL
[2025-03-25T10:04:00.863Z] [INFO] Getting market conditions for timezone: US_CENTRAL
[2025-03-25T10:04:02.525Z] GET /api/market-conditions?timezone=US_CENTRAL
[2025-03-25T10:04:02.525Z] [INFO] Getting market conditions for timezone: US_CENTRAL
[2025-03-25T10:04:05.733Z] GET /recommendations.html
[2025-03-25T10:04:05.749Z] GET /api/enhancedTemplateRecommendations
Selecting Flazh template for: Day=Tuesday, Session=Pre_Market, Volatility=Medium_Volatility
Found fallback template: EA_HIGH
Getting performance metrics for Morning, Regular, volatility: 3.1147554697362905
Selecting ATM template for: Day=Tuesday, Session=Pre_Market, Volatility=Medium_Volatility
Found fallback template: ATM_EA_HIGH
Getting performance metrics for Morning, Regular, volatility: 2.1563323806722354
[2025-03-25T10:04:15.048Z] GET /risk-dashboard.html
[2025-03-25T10:04:26.996Z] GET /recommendations.html
[2025-03-25T10:04:27.011Z] GET /api/enhancedTemplateRecommendations
Selecting Flazh template for: Day=Tuesday, Session=Pre_Market, Volatility=Medium_Volatility
Found fallback template: EA_HIGH
Getting performance metrics for Morning, Regular, volatility: 3.617794527295998
Selecting ATM template for: Day=Tuesday, Session=Pre_Market, Volatility=Medium_Volatility
Found fallback template: ATM_EA_HIGH
Getting performance metrics for Morning, Regular, volatility: 2.3906695107856857
[2025-03-25T10:04:30.674Z] GET /market-conditions.html
[2025-03-25T10:04:30.694Z] GET /api/market-conditions?timezone=US_CENTRAL
[2025-03-25T10:04:30.694Z] [INFO] Getting market conditions for timezone: US_CENTRAL
[2025-03-25T10:04:35.876Z] GET /recommendations.html
[2025-03-25T10:04:35.894Z] GET /api/enhancedTemplateRecommendations
Selecting Flazh template for: Day=Tuesday, Session=Pre_Market, Volatility=Medium_Volatility
Found fallback template: EA_HIGH
Getting performance metrics for Morning, Regular, volatility: 1.7683040764315903
Selecting ATM template for: Day=Tuesday, Session=Pre_Market, Volatility=Medium_Volatility
Found fallback template: ATM_EA_HIGH
Getting performance metrics for Morning, Regular, volatility: 3.176119645947029
Market data saved to database
Market data updated: NQ - Volatility: LOW
Market data update emitted to clients
[2025-03-25T10:05:29.935Z] GET /market-conditions.html
[2025-03-25T10:05:29.954Z] GET /api/market-conditions?timezone=US_CENTRAL
[2025-03-25T10:05:29.955Z] [INFO] Getting market conditions for timezone: US_CENTRAL
[2025-03-25T10:05:32.392Z] GET /api/market-conditions?timezone=US_CENTRAL
[2025-03-25T10:05:32.392Z] [INFO] Getting market conditions for timezone: US_CENTRAL
[2025-03-25T10:05:37.450Z] GET /recommendations.html
[2025-03-25T10:05:37.464Z] GET /api/enhancedTemplateRecommendations
Selecting Flazh template for: Day=Tuesday, Session=Pre_Market, Volatility=Medium_Volatility
Found fallback template: EA_HIGH
Getting performance metrics for Morning, Regular, volatility: 3.7978769861937596
Selecting ATM template for: Day=Tuesday, Session=Pre_Market, Volatility=Medium_Volatility
Found fallback template: ATM_EA_HIGH
Getting performance metrics for Morning, Regular, volatility: 3.0407272484242593
[2025-03-25T10:05:40.272Z] GET /market-conditions.html
[2025-03-25T10:05:40.289Z] GET /api/market-conditions?timezone=US_CENTRAL
[2025-03-25T10:05:40.290Z] [INFO] Getting market conditions for timezone: US_CENTRAL
[2025-03-25T10:06:01.038Z] GET /risk-management.html
[2025-03-25T10:06:01.053Z] GET /api/risk/dashboard
Error getting dashboard data: Error: No active risk profile found
    at RiskManagementService.getDashboardData (C:\TradingDashboard\server\services\riskManagementService.js:171:23)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async C:\TradingDashboard\server\routes\riskManagement.js:16:31
Error in risk dashboard route: Error: No active risk profile found
    at RiskManagementService.getDashboardData (C:\TradingDashboard\server\services\riskManagementService.js:171:23)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
    at async C:\TradingDashboard\server\routes\riskManagement.js:16:31
